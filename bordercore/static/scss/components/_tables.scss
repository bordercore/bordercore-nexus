// =============================================================================
// COMPONENTS: TABLES
// =============================================================================
// Table styles including Oruga tables and Bootstrap tables
// Data table (site-wide): Use .data-table-container + .data-table for new tables
// so they match todo, music, tags, fitness, reminders without repeating CSS.
// Add a second class (e.g. .todo-table) only for feature-specific overrides.

// Data table container - shared by todo, music, tags, fitness, reminders
.data-table-container {
  overflow: hidden;
  border: 1px solid var(--border-color);
  background-color: var(--surface2);
  border-radius: var(--data-table-container-radius);
  box-shadow: var(--data-table-container-shadow);
}

.is-invisible {
  visibility: hidden;
}

// Bootstrap tables - base classes first (lower specificity)
.table {
  --bs-table-border-color: var(--border-color);

  color: var(--text1);

  thead {
    border-bottom: 2px solid var(--border-color);
  }

  td, th {
    padding: 0.75rem;
    border-color: var(--border-color);
  }

  // Override Bootstrap's default border styling
  > :not(caption) > * > * {
    border-bottom-color: var(--border-color);
  }
}

.b-table {
  background-color: var(--surface2);
  color: var(--text1);
}

.table-borders {
  border: 1px solid var(--border-color);
}

.table-borderless td,
.table-borderless th {
  border: none;
}

// Data table - shared thead/tbody/tr/td styling (lower specificity tr/td before .o-table)
.data-table {
  width: 100%;
  margin-bottom: 0;
  border-collapse: collapse;
  text-align: left;

  thead {
    tr {
      border-bottom: 1px solid var(--border-color);
      background-color: var(--surface3);

      th {
        padding: var(--data-table-cell-padding);
        border: none;
        color: var(--text6);
        font-size: var(--data-table-header-font-size);
        font-weight: 600;
        letter-spacing: 0.05em;
        text-transform: uppercase;
      }
    }
  }

  tbody {
    tr {
      border-bottom: 1px solid var(--border-color);
      background-color: transparent;
      transition: background-color 0.15s ease;

      &:hover {
        background-color: var(--hover-bg);
      }

      &:last-child {
        border-bottom: none;
      }

      td {
        padding: var(--data-table-cell-padding);
        border: none;
        background-color: transparent;
        color: var(--text1);
      }
    }
  }
}

// Drill question/answer markdown-rendered tables
.table-colors {
  background-color: var(--surface2);

  table {
    overflow: hidden;
    width: 100%;
    border: 1px solid var(--border-color);
    margin: 0.5rem 0;
    border-collapse: collapse;
    border-radius: var(--border-radius1);
    color: var(--text1);

    thead {
      background-color: var(--surface3);

      th {
        padding: 0.5rem 0.75rem;
        border-bottom: 1px solid var(--border-color);
        color: var(--text6);
        font-weight: 600;
        text-align: left;
      }
    }

    tbody {
      td {
        padding: 0.5rem 0.75rem;
        border-bottom: 1px solid var(--border-color);
      }

      tr:last-child td {
        border-bottom: none;
      }
    }
  }
}

.table-responsive {
  background-color: var(--surface2);
  border-radius: var(--border-radius1);

  .table {
    margin-bottom: 0;
    color: var(--text1);
  }
}

// Oruga tables - more specific (tr:hover, .hoverable-cells td) after .data-table
/* stylelint-disable no-descending-specificity */
.o-table {
  width: 100%;
  background-color: var(--surface2);
  border-radius: var(--border-radius1);

  th {
    padding: 0.75rem;
    border-bottom: 2px solid var(--border-color);
    color: var(--text1);
    font-weight: 600;
  }

  td {
    padding: 0.75rem;
    border-bottom: 1px solid var(--border-color);
    color: var(--text1);
  }

  tr {
    transition: background-color 0.2s ease;

    &:hover {
      background-color: var(--hover-bg);
    }
  }

  &.hoverable-cells {
    td {
      transition: background-color 0.2s ease;

      &:hover {
        background-color: var(--hover-bg);
      }
    }
  }
}
/* stylelint-enable no-descending-specificity */

/* stylelint-disable selector-class-pattern */
.o-table__tr--selected {
  background-color: var(--selected-bg);
}

// Oruga mobile cards
.o-table__mobile-cards .o-table__mobile-card {
  padding: 1rem;
  border: 1px solid var(--border-color);
  margin-bottom: 1rem;
  background-color: var(--surface2);
  border-radius: var(--border-radius1);
}

// Table column width utilities
.table-col-number {
  width: 5rem;
}

.table-col-action {
  width: 3rem;
}

// =============================================================================
// Data Grid (CSS Grid-based tables with drag-and-drop support)
// =============================================================================
// Use these base classes for sortable grid tables. Define column layouts
// in page-specific SCSS files using grid-template-columns.

.data-grid-container {
  overflow: visible;
  border: 1px solid var(--border-color);
  background-color: var(--surface2);
  border-radius: var(--data-table-container-radius);
  box-shadow: var(--data-table-container-shadow);
}

.data-grid {
  display: flex;
  flex-direction: column;
}

.data-grid-header {
  border-bottom: 1px solid var(--border-color);
  background-color: var(--surface3);

  [role="columnheader"] {
    overflow: hidden;
    padding: var(--data-table-cell-padding);
    color: var(--text6);
    font-size: var(--data-table-header-font-size);
    font-weight: 600;
    letter-spacing: 0.05em;
    text-overflow: ellipsis;
    text-transform: uppercase;
    white-space: nowrap;
  }
}

.data-grid-body {
  position: relative;
  display: flex;
  flex-direction: column;
  isolation: isolate;
}

.data-grid-row {
  border-bottom: 1px solid var(--border-color);
  background-color: transparent;
  transition: background-color 0.15s ease;

  &:last-child {
    border-bottom: none;
  }

  &:hover {
    background-color: var(--hover-bg);
  }

  [role="cell"] {
    padding: var(--data-table-cell-padding);
    color: var(--text1);
  }

  // Drag handle cell
  .drag-handle-cell {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: grab;
    text-align: center;

    &:active {
      cursor: grabbing;
    }

    .hover-reveal-object {
      color: var(--drag-handle-icon-color) !important;
      opacity: 0;
      transition: opacity 0.15s ease;
    }
  }

  &.no-drag .drag-handle-cell {
    cursor: default;
  }

  &:hover .drag-handle-cell .hover-reveal-object {
    color: var(--drag-handle-icon-color) !important;
    opacity: 1;
  }

  // Sortable row transform
  &.sortable-row {
    position: relative;
    transform: var(--sortable-transform, none);
    transition: var(--sortable-transition);
  }

  // Row being dragged
  &.dragging {
    opacity: 0.4;
  }

  // Drop target indicator
  &.drag-over {
    border-top: 2px solid var(--link-color);
  }
}

// Drag overlay - rendered outside normal flow via portal (dnd-kit DragOverlay)
// Used by todo, music playlist, and bookmark tables
/* stylelint-disable no-descending-specificity */
.data-table-drag-overlay {
  padding: 0;
  background-color: var(--surface2);
  border-radius: var(--border-radius1);
  box-shadow: var(--data-table-container-shadow);
  color: var(--text1);

  .drag-overlay-title {
    padding: var(--data-table-cell-padding);
    color: var(--text1);
  }

  .drag-overlay-subtitle {
    padding: var(--data-table-cell-padding);
    margin-left: 1rem;
    color: var(--text2);
  }

  // When used with grid rows (todo), padding is on columns instead
  &.todo-grid-row {
    background-color: var(--surface3);

    [role="cell"] {
      color: var(--text1);
    }

    .todo-col-manual {
      color: var(--drag-handle-icon-color);
      text-align: center;
    }
  }

  // Bookmark overlay - replicate table row structure
  &.bookmark-grid-row {
    align-items: stretch;
    background-color: var(--surface2);

    [role="cell"] {
      display: flex;
      align-items: flex-start;
      padding: var(--data-table-cell-padding);
    }

    .drag-handle-cell {
      align-items: center;
      justify-content: center;
      color: var(--drag-handle-icon-color);
    }

    .date-cell {
      color: var(--text2);
      font-size: 0.875rem;
      white-space: nowrap;
    }

    .thumbnail-cell {
      padding-right: 0.5rem;

      img {
        border-radius: var(--border-radius1);
        object-fit: cover;
      }
    }

    .favicon-cell {
      padding-top: 0;
      padding-right: 0.5rem;

      img {
        width: 16px;
        height: 16px;
      }
    }

    .content-cell {
      color: var(--link-color) !important;

      .tag {
        color: var(--text2) !important;
        font-size: 0.8rem;
      }
    }
  }

  // Playlist song overlay - replicate table row structure
  &.playlist-grid-row {
    background-color: var(--surface3);

    [role="cell"] {
      color: var(--text1);
    }

    .playlist-col-drag {
      color: var(--drag-handle-icon-color);
      text-align: center;
    }
  }

  // Drag overlay for grid rows (shared)
  &.data-grid-row {
    background-color: var(--surface3);

    [role="cell"] {
      color: var(--text1);
    }

    .drag-handle-cell {
      color: var(--drag-handle-icon-color);
    }
  }
}
/* stylelint-enable no-descending-specificity */
